<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Peek-a-Box | Order</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
      :root {
        --primary-color: #ff4d6d;
        --secondary-color: #ff8fab;
        --background-color: #ffd6e0;
        --light-color: #ffc2d1;
      }

      body {
        background-color: var(--background-color);
        margin: 0;
        overflow-x: hidden;
      }

      /* Navigation Styles */
      .navbar {
        background-color: var(--secondary-color);
        padding: 1rem;
      }

      .navbar-brand {
        color: white !important;
        font-size: 1.5rem;
        font-weight: bold;
      }

      .nav-link {
        color: white !important;
        font-weight: 500;
        margin-left: 1rem;
      }

      /* Page Transition */
      .transition-curtain {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--primary-color);
        transform: scaleX(0);
        transform-origin: left;
        transition: transform 0.5s ease-in-out;
        z-index: 1000;
      }

      /* Hero Section */
      .hero {
        background-image: url(GAMBAR/buu.gif);
        padding: 4rem 1rem;
        text-align: center;
      }

      .hero h1 {
        color: var(--primary-color);
        font-size: 3rem;
        margin-bottom: 1rem;
      }

      .order-form {
        background-color: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .form-label {
        color: var(--primary-color);
        font-weight: 500;
      }

      .form-control:focus {
        border-color: var(--secondary-color);
        box-shadow: 0 0 0 0.25rem rgba(255, 77, 109, 0.25);
      }

      .btn-submit {
        background-color: var(--primary-color);
        color: white;
        border: none;
        padding: 10px 20px;
        width: 100%;
        border-radius: 5px;
        font-size: 1.1rem;
        transition: background-color 0.3s;
      }

      .btn-submit:hover {
        background-color: var(--secondary-color);
      }
      /* Footer */
      footer {
        background-color: var(--secondary-color);
        color: rgb(199, 65, 132);
        padding: 1rem;
        margin-top: 4rem;
      }
    </style>
  </head>
  <body>
    <!-- Transition Curtain -->
    <div class="transition-curtain"></div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
      <div class="container">
        <a class="navbar-brand" href="index.html">Peek-a-Box</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Produk.html">Products</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Order.html">Order</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero">
      <div class="container">
        <h1>Order Now</h1>
        <p>Fill out the form below to place your order!</p>
      </div>
    </div>
        <div class="container my-5">
          <div class="row justify-content-center">
            <div class="col-md-8">
              <form id="preOrderForm" name="submit-to-google-sheet">
                <!-- Date field will be handled automatically by the script -->
                <input type="hidden" name="Date" id="Date" />
                <div class="mb-3">
                  <label for="Name" class="form-label">Full Name</label>
                  <input type="text" class="form-control" id="Name" name="Name" required />
                </div>

                <div class="mb-3">
                  <label for="Email" class="form-label">Email</label>
                  <input type="email" class="form-control" id="Email" name="Email" required />
                </div>

                <div class="mb-3">
                  <label for="Phone" class="form-label">Phone Number</label>
                  <input type="tel" class="form-control" id="Phone" name="Phone" required />
                </div>

                <div class="mb-3">
                  <label for="Product" class="form-label">Product</label>
                  <select class="form-control" id="Product" name="Product" required>
                    <option value="">Choose a product...</option>
                    <option value="Sanrio Characters Fall Asleep Series">Sanrio Characters Fall Asleep Series - Rp 170.000</option>
                    <option value="Star Wars Mandalorian Series">Star Wars Mandalorian Series Figures - Rp 193.000</option>
                    <option value="Labubu Monsters Patisseries">Labubu Monsters Patisseries - Rp 168.000</option>
                    <option value="Toy Story: Andy's Room Series">Toy Story: Andy's Room Series - Rp 193.000</option>
                    <option value="Momiji Book Shop Series">Momiji Book Shop Series - Rp 168.000</option>
                    <option value="Toy Story: Spooky Night Series">Toy Story: Spooky Night Series - Rp 185.000</option>
                    <option value="Marvel Deadpool Series">Marvel Deadpool Series Figures - Rp 195.000</option>
                    <option value="Beetlejuice Series">Beetlejuice Series Figures - Rp 190.000</option>
                    <option value="CRYBABY × Powerpuff Girls">CRYBABY × Powerpuff Girls Series - Rp 179.000</option>
                    <option value="DIMOO Weaving Wonders">DIMOO Weaving Wonders Series Figures - Rp 185.000</option>
                  </select>
                </div>

                <div class="mb-3">
                  <label for="Quantity" class="form-label">Quantity</label>
                  <input type="number" class="form-control" id="Quantity" name="Quantity" min="1" required />
                </div>

                <div class="mb-3">
                  <label for="Address" class="form-label">Shipping Address</label>
                  <textarea class="form-control" id="Address" name="Address" rows="3" required></textarea>
                </div>

                <button type="submit" class="btn btn-primary">
                  <span class="spinner-border spinner-border-sm d-none" id="loadingSpinner" role="status" aria-hidden="true"></span>
                  <span id="submitText">Pre Order</span>
                </button>
              </form>
            </div>
          </div>
        </div>

        <script>
          const form = document.getElementById("preOrderForm");
          const loadingSpinner = document.getElementById("loadingSpinner");
          const submitText = document.getElementById("submitText");
          const scriptURL = "https://script.google.com/macros/s/AKfycby3dttQn-zLYOnHhropQyhrcbTf89MPe2lghaEExxtJ6UmMCbYGKUyNGzrtT8JFL9kSlQ/exec"; // Ganti dengan URL Apps Script Anda
          
          // Set field Date dengan tanggal saat ini
          document.getElementById("Date").value = new Date().toISOString().slice(0, 10); // Format: YYYY-MM-DD

          form.addEventListener("submit", (e) => {
            e.preventDefault();

            // Show loading state
            loadingSpinner.classList.remove("d-none");
            submitText.textContent = "Submitting...";

            fetch(scriptURL, {
              method: "POST",
              body: new FormData(form), // Kirim langsung FormData, tanpa JSON.stringify
            })
              .then((response) => response.json())
              .then((data) => {
                if (data.result === "success") {
                  alert("Order submitted successfully!");
                  form.reset();
                } else {
                  throw new Error("Submission failed");
                }
              })
              .catch((error) => {
                console.error("Error:", error);
                alert("There was an error submitting your order. Please try again.");
              })
              .finally(() => {
                loadingSpinner.classList.add("d-none");
                submitText.textContent = "Pre Order";
              });
          });
        </script>
      </body>
    </html>
  </body>
</html>
